# üöÄ DOODATES - PLANNING LANCEMENT D√âTAILL√â
***

## NOUVELLES IDEES
  ### HIGH
  ### MEDIUM
  ### LOW

## üìã OBJECTIF STRAT√âGIQUE

**üéØ Deadline Lancement :** Janvier 2026  
**üë• Objectif :** Lancer 4 produits   
**üåè Vision :** Architecture internationale "privacy-by-design" et "security-by-design"

---

## PLAN D'EX√âCUTION - 3H/JOUR (2H + 1H TRAVAIL DE FOND)

### üìå MERCREDI 10 D√âCEMBRE - JOUR 8

  - [ ] **Tester √† la main les favories**
          - [ ] Verification
            - [ ] Verify database changes
            - [ ] Verify API endpoints
            - [ ] Verify UI interactions

      - [ ] Jouer tous les tests e2e

  ### ‚úÖ BLOC PRODUIT ‚Äì Tests finaux 4 workflows (avant lancement)

    - **Objectif :** v√©rifier que les 4 produits sont utilisables de bout en bout sur desktop + mobile.

    - **Tests manuels communs**
      - [ ] Pour chaque produit, tester : Cr√©ation (IA + manuel) ‚Üí partage (lien) ‚Üí vote/remplissage ‚Üí r√©sultats/exports
      - [ ] V√©rifier navigation depuis le Dashboard (ouvrir, reprendre, supprimer) sans incoh√©rences
      - [ ] Contr√¥ler l‚Äôabsence d‚Äôerreurs console critiques sur les pages essentielles

    - **Produit 1 ‚Äì Sondages de dates**
      - [ ] Cr√©er un sondage simple + un sondage avec beaucoup de dates (desktop + mobile)
      - [ ] V√©rifier la navigation calendrier vers le pass√© (en lien avec le bug d√©j√† not√©)

    - **Produit 2 ‚Äì Form Polls**
      - [ ] Cr√©er un formulaire simple + un formulaire long, tester le vote complet
      - [ ] V√©rifier acc√®s aux r√©sultats + exports basiques

    - **Produit 3 ‚Äì Availability**
      - [ ] Cr√©er un sondage de dispo, partager et remplir sur mobile
      - [ ] V√©rifier que l‚Äôexp√©rience reste lisible (th√®me / layout) malgr√© les diff√©rences actuelles

    - **Produit 4 ‚Äì Quizz**
      - [ ] Cr√©er un quizz texte + un quizz √† partir d‚Äôune image
      - [ ] Tester un vote complet (score, confettis, partage du lien)

    **Id√©e d‚Äôautomatisation (plus tard)**
        - [ ] Lister pr√©cis√©ment les concurrents √† suivre (Google Forms Enterprise, Asana, Calendly, + autres si besoin) dans un fichier unique (`Docs/monitoring/produits-suivis.md`).
        - [ ] Mettre en place une veille automatis√©e simple (RSS / newsletters / changelogs officiels) et centraliser les liens.
        - [ ] Cr√©er un petit script ou agent (ex. script Node + IA) qui, une fois par mois, r√©cup√®re les notes de version et g√©n√®re un r√©sum√© structur√© :
              - Nouveaut√©s par produit.
              - Impacts possibles pour DooDates (id√©es √† copier / diff√©renciateurs).
        - [ ] Ajouter dans le planning mensuel un cr√©neau r√©current ¬´¬†Revue concurrents auto-g√©n√©r√©e¬†¬ª pour lire le r√©sum√© et d√©cider des actions (copier/am√©liorer/ignorer).

    - [x] **BLOC RGPD - 4 PRODUITS**
      - **Produit 4 ‚Äì Chat IA (Gemini / cr√©ation-modification via IA)**
      - [x] Ajouter dans l'interface du chat un encart expliquant que les messages peuvent contenir des donn√©es personnelles et passent par un fournisseur IA tiers
      - [x] V√©rifier la configuration du provider IA (d√©sactiver l'usage des donn√©es pour l'entra√Ænement si possible)
      - [x] Documenter dans la Politique de confidentialit√© le r√¥le du fournisseur IA (sous-traitant, transferts hors UE, dur√©e de conservation)
      - [x] D√©finir si les logs de conversations sont utilis√©s pour am√©liorer le produit et, le cas √©ch√©ant, anonymiser + pr√©voir opt-out

      - [x] **Test anonymisation Form Polls**
            - [x] Cr√©er un Form Poll avec plusieurs r√©ponses (nom + email visibles dans les r√©sultats)
            - [x] Depuis la page "R√©sultats" du formulaire, cliquer sur "Anonymiser les r√©ponses"
            - [x] V√©rifier que les noms/emails disparaissent (affich√©s comme "Anonyme") tout en conservant les statistiques et exports
      - [x] **Audit RGPD complet**
            - [x] Documentation fournisseur IA (sous-traitant, transferts UE, conservation)
            - [x] Interface chat IA avec informations RGPD d√©taill√©es
            - [x] Opt-out am√©lioration produit dans les param√®tres utilisateur
            - [x] Page Settings compl√®te avec gestion des pr√©f√©rences
            - [x] Audit complet document√© et automatis√©
            - **Statut :** ‚úÖ CONFORMIT√â RGPD ATTEINTE - Aucune action manuelle requise

      - [ ] **Automatisation RGPD avanc√©e** (Janvier 2026)
            - [ ] Export complet des donn√©es utilisateur (tous produits)
            - [ ] Suppression compl√®te de compte (tous produits)
            - [ ] Nettoyage automatique comptes inactifs (syst√®me)
            - **Priorit√© :** Export > Suppression > Nettoyage
        

    - [ ] **HARMONISATION DESIGN - Incoh√©rences visuelles entre produits** (12h) üé®
      
      **üìã Analyses compl√®tes (d√©tails des 10 incoh√©rences) :**
      - [Docs/ARCHITECTURE/2025-12-08-ANALYSE-DIFFERENCES-VISUELLES-PRODUITS.md](cci:7://file:///c:/Users/Julien%20Fritsch/Documents/GitHub/DooDates-testing/Docs/ARCHITECTURE/2025-12-08-ANALYSE-DIFFERENCES-VISUELLES-PRODUITS.md:0:0-0:0)
      - [Docs/ARCHITECTURE/2025-12-08-ANALYSE-COMPLETE-INCOHERENCES.md](cci:7://file:///c:/Users/Julien%20Fritsch/Documents/GitHub/DooDates-testing/Docs/ARCHITECTURE/2025-12-08-ANALYSE-COMPLETE-INCOHERENCES.md:0:0-0:0)

      **Analytics IA DatePolls**
      - [ ] Adapter PollAnalyticsService pour dates (2h)
        - [ ] Adapter algorithmes consensus pour dates
        - [ ] Calculer conflits horaires automatiquement
        - [ ] G√©n√©rer insights "Meilleure date ?"
        - Insights consensus/conflits automatiques (1h)
          - [ ] D√©tection automatique des conflits
          - [ ] Suggestions de dates alternatives
          - [ ] Visualisation heatmap disponibilit√©
        - UI panneau analytics (1h)
          - [ ] Composant `DateAnalyticsPanel.tsx`
          - [ ] Graphiques consensus/conflits
          - [ ] Export suggestions PDF


  #### üß™ Exp√©rimentation fin d√©cembre ‚Äì Interrogation orale Quizz

    **R√©f√©rence d√©taill√©e :** `Docs/PRODUCT-Quizz-Interrogation-Orale.md`

    **Objectif :** Valider en interne le mode d‚Äôinterrogation orale sur un quizz existant, et connecter l‚Äôexp√©rience aux cr√©dits IA sans ouvrir encore au public.

    **Scope MVP (fin d√©cembre, si temps disponible) :**

    - [ ] POC technique dans une page interne :
      - [ ] Lecture des questions par TTS navigateur (Web Speech API)
      - [ ] R√©ponse orale transcrite (STT navigateur ou √©quivalent simple)
      - [ ] √âvaluation de la r√©ponse via Gemini (correct / partiel / faux + explication courte)

    - [ ] Branchement sur un quizz existant (QuizzCreate/QuizzApp) avec un bouton "Interrogation orale" cach√©/exp√©rimental

    - [ ] Premier branchement logique avec les cr√©dits IA :
      - [ ] D√©cr√©menter un compteur de test (table interne) par question ou par session
      - [ ] V√©rifier que le co√ªt r√©el API reste coh√©rent avec l‚Äôexemple marge dans le doc produit

    - [ ] Rep√©r√© dans le code : Des outils quelle Factorisation et simplification de la maintenance du code

    - [ ] V√©rifier: Quand on reprend depuis le dashboard, on ne voit pas les discussions pass√©es et on ne voit pas le sondage non plus.
    
  ### üîí S√©curisation Quotas & Protection Anti-Abus

    **Mini‚Äëplanning rate limiting restant :**
    - [x] Cr√©er fonction SQL `can_consume_rate_limit(p_user_id, p_ip, p_action, p_limit_per_hour)`
    - [x] Int√©grer l‚Äôappel √† cette fonction dans l‚ÄôEdge Function `quota-tracking` avant `consume_quota_credits`
    - [x] Renvoyer `HTTP 429` + message clair si limite horaire d√©pass√©e
    - [x] Adapter `SecureGeminiService` pour afficher un message explicite de limite horaire atteinte
    - [x] Ajouter tests **unitaires** SecureGeminiService pour le mapping RATE_LIMIT ‚Üí message UI
    - [ ] Ajouter tests **E2E / load** (Playwright) pour v√©rifier blocage apr√®s X requ√™tes / heure (Edge `quota-tracking`)

    **Phase 4 : Monitoring (2h)** üîÑ PARTIEL
    - [x] Logs audit complets dans l‚ÄôEdge Function (requestId, timestamps, actions, erreurs)
    - [x] Scripts SQL / Edge Function `send-quota-report` pour reporting
    - [ ] Cr√©er un mini dashboard interne (page admin) listant les usages/quotas les plus √©lev√©s
    - [ ] Ajouter alertes anomalies (email / webhook) si un seuil est d√©pass√© (ex. > 50 cr√©dits/heure)

    **Tests :**
    - [x] Tentative bypass localStorage (doit √©chouer) - ‚úÖ V√©rifi√© c√¥t√© serveur
    - [x] Tentative extraction cl√© API (doit √™tre impossible) - ‚úÖ Cl√© c√¥t√© serveur uniquement (mode Edge)
    - [x] Tests unitaires rate limiting (SecureGeminiService, mapping RATE_LIMIT ‚Üí `RATE_LIMIT_EXCEEDED`)
    - [ ] Tests E2E rate limiting temporel (Playwright, blocage apr√®s limite horaire c√¥t√© UI)
    - [x] Test consommation atomique (pas de race condition) - ‚úÖ FOR UPDATE / RPC en DB

    **Tests E2E restants (2h) - **STABILIT√â** üõ°Ô∏è
      - [ ] R√©parer `end-to-end-with-backend.spec.ts`
      - [ ] R√©activer `ultra-simple-form.spec.ts`
      - [ ] Diagnostic h1 page vote

    **Corrections**
        - [ ] Tests manuels corrections UX
        - [ ] Validation UX post-publication
        - [ ] Tests parsing Gemini
        - [ ] En case de regroupement, cacher et interdire de d√©finir des horaires et griser le bouton
        - [ ] Regroupement visuel des dates ne fonctionne pas sur mobile (fond bleu continu)

    - [ ] **Sondage disponibilit√©** : Exiger un compte utilisateur (s√©curit√© + tra√ßabilit√©)
    
    #### Sections de questions (1-2h) ‚è≥ EN DISCUSSION

    **Concept :** Permettre de grouper les questions par th√®mes/sections pour am√©liorer la lisibilit√©.

    **Approche propos√©e : Sections int√©gr√©es dans la liste**
    - Au lieu de Q1, Q2, Q3... ‚Üí S1 (Section 1), Q1, Q2, S2 (Section 2), Q3...
    - Type `FormItem = FormQuestion | FormSection`
    - Boutons "Ajouter question" et "Ajouter section" dans la m√™me liste
    - Sections = cards visuelles avec fond diff√©rent + ic√¥ne

    **Exemple visuel :**
    ```
    üìã S1. Informations personnelles
        Vos coordonn√©es de base

    Q1. Nom
    Q2. Email

    üí≠ S2. Feedback
        Votre avis sur notre service

    Q3. Satisfaction (1-5)
    Q4. Commentaires
    ```

    **Impl√©mentation (1-2h) :**
    - [ ] Ajouter type `FormSection` dans `pollStorage.ts`
    - [ ] Modifier `FormEditor` pour supporter sections + questions
    - [ ] UI : Boutons "Ajouter question" / "Ajouter section"
    - [ ] Rendu visuel : Cards sections avec style distinct
    - [ ] Mode classique : Sections = s√©parateurs visuels
    - [ ] Mode multi-step : Afficher titre section au-dessus de la question

    **Avantages :**
    - ‚úÖ Simple et flexible
    - ‚úÖ Am√©liore lisibilit√© formulaires longs
    - ‚úÖ Pas de refonte majeure
    - ‚úÖ Compatible avec modes classique ET multi-step

    **Statut :** ‚è≥ EN DISCUSSION - Attente d√©cision utilisateur

  #### Acc√®s aux r√©sultats FormPoll + Email confirmation (6h30) ‚úÖ TERMIN√â

    **Probl√®me actuel :**
    - ‚ùå Bouton "Voir les r√©sultats" affich√© mais acc√®s refus√© (frustrant)
    - ‚ùå Pas de contr√¥le pour le cr√©ateur sur qui peut voir les r√©sultats
    - ‚ùå Pas de copie des r√©ponses par email pour le votant

    **Solution :** Voir documentation utilisateur `USER-DOCUMENTATION/04-Formulaires-Questionnaires.md` et `USER-DOCUMENTATION/06-Gestion-Resultats.md`.

    **1. Visibilit√© des r√©sultats (2h30) ‚úÖ**
    - [x] Ajouter champ `resultsVisibility` dans interface `Poll` (3 modes : creator-only, voters, public)
    - [x] Cr√©er UI radio buttons dans `FormPollCreator.tsx` pour choisir la visibilit√©
    - [x] Impl√©menter helpers `getCurrentUserId()` et `checkIfUserHasVoted()`
    - [x] Ajouter contr√¥le d'acc√®s dans `FormPollResults.tsx` (v√©rifier permissions)
    - [x] Modifier √©cran post-vote pour afficher bouton conditionnel "Voir les r√©sultats"
    - [x] Afficher message explicatif si acc√®s refus√©

    **2. Email de confirmation (3h) ‚úÖ**
    - [x] Ajouter champ `respondentEmail` dans interface `FormResponse`
    - [x] Cr√©er checkbox "Recevoir une copie par email" dans `FormPollVote.tsx`
    - [x] Ajouter input email conditionnel (visible si checkbox coch√©e)
    - [x] Modifier `addFormResponse()` pour stocker l'email
    - [x] Cr√©er service `EmailService.ts` avec fonction `sendVoteConfirmationEmail()`
    - [x] Int√©grer appel service apr√®s soumission (console.log MVP, Resend API en Phase 2)

    **3. Tests d'int√©gration (1h30) ‚úÖ**
    - [x] Tests validation champs requis ‚úÖ
    - [x] Tests flow vote avec email ‚úÖ
    - [x] Correction TypeScript (types litt√©raux `as const`) ‚úÖ
    - [x] Nettoyage fichiers tests complexes ‚úÖ
    - [x] **Correction hooks React incoh√©rents** ‚úÖ
    - [x] **Correction import `getCurrentUserId` manquant** ‚úÖ

    **Statut final :** ‚úÖ **FONCTIONNELLEMENT TERMIN√â** - Tests 100% fonctionnels, TypeScript valide, hooks React corrig√©s.

---

### üìå MARDI 10 D√âCEMBRE - JOUR 6

**üéØ MISSION : NETTOYAGE TESTS FORMPOLLVOTE** ‚úÖ TERMIN√â

**Probl√®mes identifi√©s :**
- ‚ùå Erreurs TypeScript dans multiples fichiers de tests
- ‚ùå Hooks React incoh√©rents dans `FormPollVote.tsx`
- ‚ùå Import `getCurrentUserId` manquant

**Corrections apport√©es :**
- ‚úÖ **Correction hooks React** : D√©placement `useMemo` hors condition (lignes 44-63)
- ‚úÖ **Correction import manquant** : Ajout `getCurrentUserId` dans imports (ligne 3)
- ‚úÖ **Nettoyage tests** : Suppression fichiers complexes avec erreurs TypeScript
- ‚úÖ **Tests stables conserv√©s** : 2 tests fonctionnels dans `FormPollVote-integration.test.tsx`

**R√©sultats finaux :**
- ‚úÖ **2/2 tests passent** (validation champs + flow email)
- ‚úÖ **TypeScript valide** (`npm run type-check` passe)
- ‚úÖ **Plus d'erreurs hooks React**
- ‚úÖ **Code propre et maintenable**

**Fichiers modifi√©s :**
- `src/components/polls/FormPollVote.tsx` - Hooks corrig√©s
- `src/components/__tests__/FormPollVote-integration.test.tsx` - Tests stables
- `Docs/2. Planning - Decembre.md` - Statut mis √† jour

**Prochains travaux :** Continuer Phase 3 - Polish UX et animations

---

## üéØ R√âSUM√â DES PROGR√àS

### ‚úÖ **Phase 1 : Base FormPolls** - TERMIN√â
- Cr√©ation et vote fonctionnels
- Types de questions de base (text, single, multiple)

### ‚úÖ **Phase 2 : Features avanc√©es** - TERMIN√â  
- Exports 4 formats (CSV, PDF, JSON, Markdown)
- R√®gles conditionnelles fonctionnelles
- Questions matrices avec rendu complet
- UX post-publication align√©e

### ‚úÖ **Phase 3 : Tests & Stabilit√©** - TERMIN√â
- Acc√®s r√©sultats par visibilit√© (creator-only, voters, public)
- Email confirmation pour votants
- Tests d'int√©gration fonctionnels et propres
- Hooks React corrig√©s et TypeScript valide

### üîÑ **Phase 4 : Polish UX** - EN COURS
- Animations et feedback visuel
- Suggestions intelligentes
- Undo/Redo functionality

---

## üìä **STATUT TECHNIQUE**

**Tests :** ‚úÖ 2/2 FormPollVote integration tests passent  
**TypeScript :** ‚úÖ `npm run type-check` valide  
**Qualit√© :** ‚úÖ Hooks React conformes, code propre  
**Production :** ‚úÖ Fonctionnalit√©s FormPolls compl√®tes  

**Prochaine √©tape :** Session 1 UX - Animations et feedback visuel

---

## üéØ **CONCLUSION**

Les fonctionnalit√©s **FormPolls** sont maintenant **termin√©es et production-ready** avec :

- ‚úÖ **Tests stables** : 2/2 integration tests passent
- ‚úÖ **TypeScript valide** : `npm run type-check` propre  
- ‚úÖ **Hooks React conformes** : Plus d'erreurs
- ‚úÖ **Fonctionnalit√©s compl√®tes** : Vote, exports, r√©sultats, email

**Prochaines √©tapes :** Phase 4 - Polish UX avec animations et suggestions intelligentes.

---

*Document mis √† jour le 10 d√©cembre 2025*
