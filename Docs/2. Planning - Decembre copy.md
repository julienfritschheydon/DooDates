# ğŸš€ DOODATES - PLANNING BÃŠTA DÃ‰TAILLÃ‰
***

## NOUVELLES IDEES
  ### HIGH
    - Revenir Ã  CrewAI, oui et pourquoi ? Test surtout.
  ### MEDIUM
    - Suivre les release de Google Form Enteprise pour nous et faire pareil voir mieux pour les gens n'ayant pas accÃ¨s 
  ### LOW
  - Comparer : Asana
  - Ã‰tudier commetaire calendly et le prix

## ğŸ“‹ OBJECTIF STRATÃ‰GIQUE

**ğŸ¯ Deadline BÃªta :** Fin dÃ©cembre 2025  
**ğŸ‘¥ Objectif :** Lancer une bÃªta fonctionnelle avec 10-20 utilisateurs testeurs  
**â±ï¸ Rythme :** **3h par jour** (2h critiques + 1h travail de fond)  
**ğŸŒ Vision :** Architecture internationale "privacy-by-design" et "security-by-design"

---

## PLAN D'EXÃ‰CUTION - 3H/JOUR (2H + 1H TRAVAIL DE FOND)

### Semaine 1 : Architecture Structurante + StabilitÃ© Critique

- âœ… **Lundi :** **Architecture Backend Commun** (2h) â­
  - âœ… **AJOUT :** DÃ©tection gÃ©ographique (Cloudflare + IPinfo) - TERMINÃ‰
    - [x] Choisir API (IPinfo vs Cloudflare Geo)
    - [x] CrÃ©er service `geo-detection.ts`
    - [x] IntÃ©grer middleware Express
    - [?? ] Tests E2E localisation (VPN test)
  - âœ… **AJOUT :** Pricing multi-rÃ©gions (price lists) - TERMINÃ‰
    - [x] CrÃ©er tables `regions` + `price_lists`
    - [x] Service `pricing-service.ts`
    - [x] IntÃ©grer dÃ©tection auto-rÃ©gion
    - [x] Tests conversion devises
  - âœ… **AJOUT :** Tests dÃ©tection gÃ©ographique
    - [x] Test dÃ©tection pays via IP
    - [x] Test VPN detection (optionnel)
    - [x] Test fallback rÃ©gion par dÃ©faut
    - [x] Test pricing par rÃ©gion automatique
  - [x]**Tester les changements sur les formulaires**

- âœ… **Mardi :** **Finalisation + SÃ©curitÃ© Backend** (2h) â­
  - âœ… **INTÃ‰GRATION GOOGLE SIGN-IN** - TERMINÃ‰
    - [x] Boutons Google dans SignInForm et SignUpForm
    - [x] Gestion des Ã©tats de chargement et erreurs
    - [x] Connexion via OAuth avec Supabase
    - [x] Tests de compilation et build rÃ©ussis    
  - âœ… **RÃ‰SOLUTION DES CONFLITS DE TYPES GEMINI** - TERMINÃ‰
    - [x] CrÃ©ation d'un fichier `poll-suggestions.ts` centralisÃ©
    - [x] Unification des types `PollSuggestion`, `FormPollSuggestion` et `DatePollSuggestion`
    - [x] Correction des imports dans `GeminiChatInterface.tsx` et `ConversationService.ts`
    - [x] Gestion du type `"date"` dans `QuestionType`
    - [x] RÃ©solution des conflits de types avec `dateGroups`
    - [x] Correction de `setLastAIProposalAdapter`
  - âœ… BUG - Alignement des jours et des horaires (select lots of days to show it) (15 min)
  - âœ… **â° Bloc 2 : SÃ©curitÃ© & RGPD (TERMINÃ‰) âœ…** ğŸ”’
  - âœ… **IMPLÃ‰MENTÃ‰ :** SÃ©curitÃ© quotas & rate limiting
      - [x] Service `rate-limiter.ts` (10 req/min) - 30 min
        - Gestion des fenÃªtres de temps
        - Blocage aprÃ¨s dÃ©passement
        - Tests unitaires complets
      - [x] Middleware protection quotas - 20 min
        - IntÃ©gration avec l'API
        - Gestion des erreurs
  - âœ… **IMPLÃ‰MENTÃ‰ :** Logs RGPD (consentement, IP hash)
      - [x] Service `consent-logger.ts` - 15 min
        - Journalisation des consentements
        - Export des donnÃ©es utilisateur
        - Suppression des donnÃ©es
      - [x] IP hash SHA-256 (jamais en clair) - 10 min
        - Hachage sÃ©curisÃ©
        - Anonymisation des adresses IP
        - Gestion des erreurs
  - âœ… **â° Bloc 3 : Architecture Backend (1h)** ğŸ—ï¸
    - [x] **SÃ©parer services par produit**
        - [x] Identifier API partagÃ©e (auth, quotas, conversations)
        - [x] Documentation architecture backend â†’ **Voir @[Analyse - SÃ©paration Services par Produit.md]**
        - [x] CrÃ©er structure dossiers backend commune - 15 min
        - [x] **Scission structure progressive** - 25 min
          - [x] CrÃ©er dossiers products/shared/ai (5 min)
          - [x] DÃ©placer gemini.ts dans ai/ (5 min)
          - [x] CrÃ©er wrappers pollStorage (10 min)
          - [x] Mettre Ã  jour imports critiques (5 min)
    - âœ… **Scission pollStorage.ts** â†’ **COMPLÃ‰TÃ‰ AVEC SUCCÃˆS**
      - âœ… SÃ©parer date-polls/form-polls/quizz services
      - âœ… Maintenir interface unifiÃ©e via index.ts
      - âœ… Tests validation rapides (E2E: 11/11 passÃ©s)
      - âœ… **RÃ‰SULTAT :** 1343 lignes â†’ 3 services spÃ©cialisÃ©s (1204 lignes total)
  - âœ… **AMÃ‰LIORATION DOCUMENTATION MOBILE**
    - [x] Menu hamburger pour navigation mobile
    - [x] Backdrop pour fermeture au clic
    - [x] Animation fluide d'ouverture/fermeture
    - [x] Correction du padding et de la mise en page
  - âœ… **REFACTORISATION TYPES GEMINI**
    - [x] DÃ©placer les types `PollSuggestion` vers `poll-suggestions.ts`
    - [x] Mettre Ã  jour les imports dans `useGeminiAPI.ts`
    - [x] Ajouter le typage correct pour la rÃ©ponse de l'API
  - âœ… **TESTS BACKEND CRITIQUES** âœ… **DÃ‰JÃ€ IMPLÃ‰MENTÃ‰S** â­
    - âœ… ğŸ”’ **SÃ©curitÃ© Quotas & Rate Limiting**
      - âœ… **Tests unitaires** : `rate-limiter.test.ts` (180 lignes)
      - âœ… **Service** : `rate-limiter.ts` (247 lignes)
      - âœ… **Middleware** : `middleware.ts` (244 lignes)
      - âœ… **Tests E2E** : `security-rate-limiting-rgpd.spec.ts` (lignes 21-147)
        - Rate limiting (10 req/min par IP)
      - Injection quotas manuels
      - Contournement guest limits
      - Protection DDoS basique
    - âœ… ğŸ“œ **ConformitÃ© RGPD**
      - âœ… **IP Hashing** : `ip-hash.test.ts` (266 lignes)
      - âœ… **Consentement** : `consent-logger.test.ts` (258 lignes)
      - âœ… **Tests E2E** : `security-rate-limiting-rgpd.spec.ts` (lignes 150-254)
        - BanniÃ¨re consentement
        - Protection donnÃ©es personnelles
        - Droit Ã  l'oubli
    - âœ… ğŸ”„ **API PartagÃ©es**
      - âœ… **Tests d'intÃ©gration** : `api-security-performance.spec.ts` (319 lignes)
        - Authentification (Supabase)
        - Gestion des quotas (RPC)
        - CRUD conversations
        - Performance (<2s lecture, <1s crÃ©ation)
        - SÃ©curitÃ© RLS (Row Level Security)
    - âœ… ğŸ“Š **Couverture des Tests**
      - âœ… Tests unitaires complets
      - âœ… Tests d'intÃ©gration critiques
      - âœ… Tests E2E sÃ©curitÃ©
      - âœ… VÃ©rification RLS et permissions
  - âœ… Tests E2E sÃ©curitÃ© (rate limiting, RGPD) - **9/9 passÃ©s**
  - âœ… Tests API partagÃ©es (auth, quotas, conversations) - **DÃ©jÃ  implÃ©mentÃ©s**
  - âœ… Documentation types partagÃ©s services
  - âœ… Structure frontend multi-produits - **100% TERMINÃ‰E** - **100% TERMINÃ‰E**

  - [x] ğŸ” Tests Unitaires Manquants
    **1. Date Polls Service**
    - [x] Tests de validation des crÃ©neaux horaires
    - [x] Gestion des fuseaux horaires
    - [x] Tests de performance avec un grand nombre de dates

    **2. Form Polls Service**
    - [x] Tests de performance avec de nombreux rÃ©pondants
    - [x] Gestion des rÃ©ponses partielles

  - [ ] ğŸ”— Tests d'IntÃ©gration
    **Structure Frontend Multi-Produits**
    - [x] Validation des wrappers de rÃ©trocompatibilitÃ©
    - [x] Validation des types de questions personnalisÃ©es
    - [x] CrÃ©er structure dossiers frontend par produit
    - [x] Tests edge cases (localStorage, conflits)
    - [x] Tests de charge avec l'interface unifiÃ©e
    - [x] Mettre en place routage par produit

### ğŸ“Œ MERCREDI 4 DÃ‰CEMBRE - JOUR 3

  - [x] **Structure Frontend Multi-Produits**
    - [x] Landing pages sÃ©parÃ©es par types
    - [x] Optimisation des imports/bundles -  on a fait ca ?
    - [x] Documentation utilisateur finale


### ğŸ“Œ JEUDI 5 DÃ‰CEMBRE - JOUR 4

  - [ ] ğŸ”´ **BUGS CRITIQUES Ã€ CORRIGER (CETTE SEMAINE)** - Priorisation par impact
    - [ ] **ğŸ”¥ URGENT - Discussions DupliquÃ©es** (1-2h) - 5x mÃªme sondage aprÃ¨s refresh
      - Impact : UX cassÃ©e, confusion utilisateur
      - Risque : Perte de confiance utilisateur
    - [ ] **âš ï¸ HAUTE - Tests E2E Ã‰chouent** (2-3h) - `end-to-end-with-backend.spec.ts` (10 test.skip)
      - Impact : Bloque la CI/CD
      - Risque : RÃ©gressions non dÃ©tectÃ©es
    - [ ] **ğŸ“Š MOYENNE - Bug Quota IncohÃ©rent** (4-6h) - Dashboard vs Edge Function
      - Impact : Affichage incorrect mais fonctionnel
      - Risque : Confusion mais pas bloquant

  - [ ] âŒ **BUG GOOGLE AUTH - NON RÃ‰SOLU**
    - [x] Modification `AuthContext.tsx` ligne 275 : `redirectTo: ${window.location.origin}/DooDates/auth/callback`
    - [x] Configuration Supabase : URLs de redirection ajoutÃ©es
    - âŒ **PROBLÃˆME PERSISTANT** : URL finale contient `/DooDates/DooDates/dashboard` (duplication)
    - **CAUSE** : Conflit entre `vite.config.ts` (`base: "/DooDates/"`) et `BrowserRouter` (`basename="/DooDates"`)
    - **Ã€ INVESTIGUER** : Trouver la source de la duplication du path

  - [ ] **Tests de rÃ©gression post-scission** (2h) â­ **PRIORITÃ‰ APRÃˆS SCISSION**
    - [ ] VÃ©rifier que tous les E2E passent encore (11/11)
    - [ ] Tests manuels des 3 types de sondages (date/form/availability)
    - [ ] VÃ©rifier que les imports fonctionnent correctement
    - [ ] Valider les wrappers de rÃ©trocompatibilitÃ©
    - [ ] Tests de performance (temps de chargement)

  - [ ] **PROBLEME - dashboard-complete.spec.ts en mode 'serial'**

  - [x] ~~**Availability Polls Service**~~ â†’ **REPORTER aprÃ¨s stabilisation**
    - Raison : Stabiliser la scission avant d'ajouter de nouvelles fonctionnalitÃ©s

### ğŸ“Œ VENDREDI 6 DÃ‰CEMBRE - JOUR 5

  - [ ]**Navigation calendrier vers le passÃ© :**
    - [ ] BUG Navigation calendrier vers le passÃ© - PARTIELLEMENT CORRIGÃ‰
    - [ ] ProblÃ¨me : Bouton "prev" ne montre pas mois prÃ©cÃ©dent (scroll nÃ©cessaire)
    - [ ] Correction : useEffect + scrollLeft = 0 dans Calendar.tsx
    - [ ] Restant : ExpÃ©rience visuelle diffÃ©rente entre prev/next
    - [ ] Fichiers : Calendar.tsx, PollCreator.tsx, usePollCreatorState.ts
    - [ ] Tests : Calendar-navigation.test.tsx crÃ©Ã©s

  - [ ] **Navigation & Chat :**
    - [ ] Discussions passÃ©es non visibles depuis dashboard

  - [ ] **Documentation - AmÃ©lioration Screenshots (1h)** 
    - [ ] Page `03-Sondages-Dates.md` : Ajouter screenshot manquant
    - [ ] Corriger alignement tableau + "Horaires par Date" â†’ "Horaires par date"
    - [ ] Simplifier grandement la documentation

ğŸ”¹ **DÃ‰PLOIEMENT ET TESTS**
- [ ] DÃ©ploiement sur l'environnement de test
- [ ] Tests utilisateur finaux
- [ ] Correction des bugs critiques

## ğŸ“… SEMAINE 2 - 9-13 DÃ‰CEMBRE 2024

### ğŸ“Œ LUNDI 9 DÃ‰CEMBRE - JOUR 6

ğŸ”¹ **DÃ‰PLOIEMENT EN PRODUCTION**
- [ ] DÃ©ploiement progressif
- [ ] Monitoring des erreurs
- [ ] Support utilisateur

**+1h Travail de fond :** **Fingerprinting Phase 3 - Tests Dashboard Admin**
- [ ] AccÃ¨s `/admin/quotas` avec compte admin
- [ ] VÃ©rifier affichage quotas guests, filtres, statistiques
- [ ] Tester rafraÃ®chissement automatique et recherche

**Jeudi :** **Extraction Composants Communs** (2h) â­

- [ ] **AJOUT :** TopNav avec sÃ©lecteur langue
  - [ ] Ajouter dropdown langues (ğŸ‡«ğŸ‡· ğŸ‡¬ğŸ‡§ ğŸ‡©ğŸ‡ª ğŸ‡®ğŸ‡³)
  - [ ] Hook `useLanguage()` avec persistence localStorage
  - [ ] Tests changement langue dynamique
  - [ ] Mise Ã  jour traductions instantanÃ©es

- [ ] **AJOUT :** GeoBanner (conformitÃ© UE 2018/302)
  - [ ] Composant `GeoBanner.tsx` pour utilisateurs UE
  - [ ] Message conformitÃ© cookies/localisation
  - [ ] Condition affichage par dÃ©tection IP
  - [ ] Tests affichage banner UE vs non-UE

- [ ] **AJOUT :** Security headers & rate limiting UI
  - [ ] Indicateur visuel rate limiting atteint
  - [ ] Messages erreur sÃ©curitÃ© clairs
  - [ ] Tests UX limites quotas dÃ©passÃ©s

  **+1h Travail de fond :** **Fingerprinting Phase 3 - Tests Migration**
  - [ ] CrÃ©er conversations/polls en mode guest
  - [ ] Se connecter et vÃ©rifier migration fingerprint â†’ compte
  - [ ] VÃ©rifier prÃ©servation compteurs et idempotence

  **+1h Travail de fond :** **Bug Quota IncohÃ©rent**
  - [ ] Analyser flux Dashboard vs Edge Function
  - [ ] Unifier systÃ¨me de quotas
  - [ ] **AJOUT :** SÃ©curisation quotas (dÃ©jÃ  implÃ©mentÃ©)
  - [ ] **AJOUT :** Documentation sÃ©curitÃ© & monitoring
  - [ ] Tests E2E cohÃ©rence quotas
  - [ ] Documentation flux consommation

  **+1h Travail de fond :** **Test Refactoring - Validation Tests RÃ©activÃ©s** âœ…
  - [x] GeminiChatInterface (tests de types rÃ©solus)
  - [ ] unified-flow, useIntentDetection
  - [ ] AuthContext, OnboardingContext, useFreemiumQuota
  - [ ] ConversationSearch, ConversationList, ConversationCard
  - [ ] Diagnostic h1 page vote

**Vendredi :** 
  - [ ] **Prototype Aide aux Devoirs** (2h + 1h)
    - [ ] Interface quizz simple (photo â†’ questions)
    - [ ] Architecture mobile-ready
    - [ ] Support multi-langues (fr/en)
    - [ ] Logique correction basique
    - [ ] IntÃ©gration backend commun

### Semaine 2 : StabilitÃ© + Refactors CiblÃ©s

**Lundi :** Tests E2E restants (2h) - **STABILITÃ‰** ğŸ›¡ï¸
- [ ] RÃ©parer `end-to-end-with-backend.spec.ts`
- [ ] RÃ©activer `ultra-simple-form.spec.ts`
- [ ] Diagnostic h1 page vote

  **+1h Travail de fond :** **Tests manuels corrections**
  - [ ] Tests manuels corrections UX
  - [ ] Validation UX post-publication
  - [ ] Tests parsing Gemini
    - [ ] "Sondage pour week-end ski dÃ©cembre" â†’ formulaire (devrait Ãªtre dates)
    - [ ] "dÃ©jeuner semaine prochaine" â†’ une seule date (devrait Ãªtre plusieurs)
    - [ ] En case de regroupement, cacher et interdire de dÃ©finir des horaires et griser le bouton
    - [ ] "Sondage pour un week-end de ski en dÃ©cembre" crÃ©Ã© un formulaire (devrait Ãªtre dates)
    - [ ] "fais-moi un sondage pour un dÃ©jeuner la semaine prochaine" â†’ une seule date (devrait Ãªtre plusieurs)
    - [ ] Regroupement visuel des dates ne fonctionne pas sur mobile (fond bleu continu)

**Mardi :** Bugs UX Bloquants (2h) - **STABILITÃ‰** ğŸ›¡ï¸
- [ ] DisponibilitÃ©s : exiger un compte utilisateur (sÃ©curitÃ© + traÃ§abilitÃ©)
- [ ] Discussions dupliquÃ©es (5x mÃªme sondage)
- [ ] Message quota incorrect
- [ ] Tests manuels corrections

  **+1h Travail de fond :** **Documentation Screenshots**
  - [ ] Page `03-Sondages-Dates.md` : Ajouter screenshot manquant
  - [ ] Corriger alignement tableau + "Horaires par Date" â†’ "Horaires par date"
  - [ ] Simplifier grandement la documentation

**Mercredi :** **Refactor PollCreator Hook** (2h) - **REFACTOR** â­
  - [ ] Extraire usePollCreatorState (500 lignes)
  - [ ] RÃ©duire PollCreator de 1650 â†’ 1150 lignes
  - [ ] Tests validation refactor immÃ©diate
  - [ ] Branch Git isolÃ©e pour rollback facile

  **+1h Travail de fond :** **Tests Antigravity**
  - [ ] Tests regroupement visuel mobile
  - [ ] Tests navigation dashboard â†’ discussions
  - [ ] Tests parsing Gemini avancÃ©

**Jeudi :** **Tests + Documentation** (2h) - **STABILITÃ‰** ğŸ›¡ï¸
- [ ] Valider refactor PollCreator (tests E2E complets)
- [ ] Documentation architecture refactorÃ©e
- [ ] Tests de performance post-refactor
- [ ] PrÃ©paration refactor suivant (analyse gemini.ts)

  **+1h Travail de fond :** **Google Calendar - Documentation**
  - [ ] Documenter comportements attendus vs observÃ©s
  - [ ] AmÃ©liorer affichage conflits utilisateur
  - [ ] Cas d'usage avancÃ©s

**Vendredi :** **Refactor gemini.ts Modules** (2h) - **REFACTOR** â­
- [ ] Scinder en 3 modules (service/prompts/utils)
- [ ] RÃ©duire 2072 â†’ 3x700 lignes
- [ ] Tests modules isolÃ©s
- [ ] Branch Git isolÃ©e pour rollback facile

  **+1h Travail de fond :** **Fingerprinting - Tests approfondis**
  - [ ] Tests multiples fingerprints diffÃ©rents
  - [ ] Validation accÃ¨s non-admin ("Access Denied")
  - [ ] Tests formatage dates et badges confidence

### Semaine 3 : Tests Gemini RÃ©els + Architecture

**Lundi :** 
- [ ] `test-gemini-comprehensive.js` (2h)
- [ ] Tests complets cas edge
- [ ] Validation hints conditionnels

- [ ] `debug-isolation.js` (2h)
- [ ] Debug rule-by-rule
- [ ] Isolation problÃ¨mes spÃ©cifiques

- [ ] `system-comparison.js` (2h)
- [ ] Comparaison ancien vs nouveau systÃ¨me
- [ ] Benchmarks performance

- [ ] **Architecture isComplexCase()** (2h) â­
- [ ] ImplÃ©menter logique conditionnelle hints
- [ ] Tests validation performance
- [ ] Documentation architecture
- [ ] Benchmarks performance (simple vs complex prompts)

- [ ] `gemini-date-polls.test.ts` (2h)
- [ ] 48 tests dates avec annÃ©es futures
- [ ] Tests parsing complexe

- [ ] `gemini-form-polls.test.ts` (2h)
- [ ] 10 tests formulaires
- [ ] Tests IA gÃ©nÃ©ration

- [ ] `gemini-comprehensive.test.ts` (2h)
- [ ] Tests combinÃ©s cross-produits
- [ ] Validation architecture

**Mardi :** 

**Mercredi :** 

**Jeudi :** 

**Vendredi :** 

### Semaine 4 : Tests Gemini + Finalisation BÃªta

**Lundi :** 

**Mardi :** 

**Mercredi :** 
  **+1h :** Analytics IA DatePolls
    - Adapter PollAnalyticsService pour dates (2h)
      - [ ] Adapter algorithmes consensus pour dates
      - [ ] Calculer conflits horaires automatiquement
      - [ ] GÃ©nÃ©rer insights "Meilleure date ?"
    - Insights consensus/conflits automatiques (1h)
      - [ ] DÃ©tection automatique des conflits
      - [ ] Suggestions de dates alternatives
      - [ ] Visualisation heatmap disponibilitÃ©
    - UI panneau analytics (1h)
      - [ ] Composant `DateAnalyticsPanel.tsx`
      - [ ] Graphiques consensus/conflits
      - [ ] Export suggestions PDF

**Jeudi :** **Tests Transverses** (2h + 1h)
  - [ ] Tests E2E cross-produits
  - [ ] Tests sÃ©curitÃ© multi-rÃ©gions
  - [ ] Tests conformitÃ© RGPD

  - **+1h :** Tests Analytics DatePolls
    - [ ] Validation architecture sÃ©parÃ©e
    - [ ] Tests intÃ©gration finaux

**Vendredi :** **Finalisation BÃªta** (2h + 1h)
  - [ ] Documentation utilisateur
  - [ ] Page "Transparence & Impact"
  - [ ] Configuration Supabase production
  - [ ] Documentation SÃ©curitÃ© & RGPD

  **+1h :** Consolidation Tests E2E
  - [ ] PrÃ©paration bÃªta
  - [ ] Checklist lancement
  - [ ] Tests finaux


