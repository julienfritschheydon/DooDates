# DooDates - Development Planning

## 1. NOW - Current Work & Immediate Blockers

### üî• En cours (Priorit√© Absolue)

#### Phase 3 : Tests Hooks Critiques (Migration Jest‚ÜíVitest)
**Objectif** : Migrer les 3 hooks les plus critiques encore en `.skip`

üìÑ **D√©tails techniques** : Voir [TEST-STATUS.md](../TEST-STATUS.md) pour la liste compl√®te des fichiers et le guide de migration.

**Ordre d'ex√©cution recommand√©** :
1. ‚úÖ ~~**`useConversations.test.ts`**~~ - **TERMIN√â 14/14 tests (100%)** üéâ
   - Dur√©e r√©elle: 2h (API compl√®tement chang√©e, refactor complet n√©cessaire)
   - Gain: +14 tests

2. ‚úÖ ~~**`useConversationStorage.test.ts`**~~ - **PARTIEL 6/13 tests (46%)** ‚ö†Ô∏è
   - Dur√©e r√©elle: 45min (migration Jest‚ÜíVitest OK, mais mutations non testables)
   - Gain: +6 tests passent, +7 tests skipp√©s (n√©cessitent refactor API)
   - Note: Hook utilise wrappers personnalis√©s, tests CRUD √† refaire

3. **`useAutoSave.test.ts`** (45-60 min)
   - Fix timeout 5000ms + timer mocks (`vi.useFakeTimers()`)
   - Hook critique pour sauvegarde
   - ~15-20 tests attendus

**R√©sultat actuel** : 
- ‚úÖ +26 tests ajout√©s (385/410 actuellement = 93.9%)
- ‚úÖ useConversations: 14/14 (100%)
- ‚ö†Ô∏è useConversationStorage: 6/13 (46%, 7 skipp√©s)
- ‚è≠Ô∏è Reste: useAutoSave (~15-20 tests)

**Reporter √† plus tard** :
- `useFreemiumQuota.test.ts` - N√©cessite refactor complet (API chang√©e)
- `QuotaIndicator.test.tsx` - N√©cessite refactor complet (API chang√©e)
- Ces deux fichiers = 1-2h de refactor chacun (pas juste une migration)

**Status actuel** :
- ‚úÖ Phase 1 : Tests Simples (2/3 compl√©t√©s)
- ‚úÖ Phase 2 : Tests Composants (2/2 compl√©t√©s) 
- üîÑ Phase 3 : Tests Hooks Critiques (2/3 compl√©t√©s) ‚¨ÜÔ∏è
  - ‚úÖ useConversations: 14/14 (100%)
  - ‚ö†Ô∏è useConversationStorage: 6/13 (46%, 7 skipp√©s)
  - ‚è∏Ô∏è useAutoSave: 0/? (en attente)
- ‚è∏Ô∏è Phase 4 : Tests Int√©gration (0/3)

---

### üéØ Cette semaine

#### Interface chat am√©lior√©e - Form Poll par IA
**Objectif :** Ajouter la cr√©ation de questionnaires via l'IA conversationnelle

- Cr√©ation de questionnaire par IA, en plus des sondages de dates
- Modification possible d'un sondage ou d'un questionnaire
- **üìÑ Sp√©cifications compl√®tes** : Voir [Form-Poll-AI-Creation.md](./Form-Poll-AI-Creation.md)
- **Dur√©e estim√©e** : 12h (5 phases)
- **Statut** : Sp√©cifications compl√®tes - Pr√™t pour impl√©mentation


## 2. NEXT - MVP Features (par th√®me)

### Form Poll Features
- **Multi-step Flow** (Typeform-style) : Une question par √©cran, barre de progression, validation par √©tape
- **Results Display** : Histogrammes r√©sultats FormPoll (mini barres horizontales)
- **QUESTION** : Seuils de pagination (texte >50 r√©ponses ‚Üí ¬´ Voir plus ¬ª, nombre N pour Dashboard)
- **QUESTION** : √âchelle histogrammes (pourcentage vs valeur brute, troncature labels, affichage ex-aequo)

### IA Conversationnelle Avanc√©e
**Objectif :** IA compl√®te avec parsing avanc√©

**Fonctionnalit√©s IA avanc√©es :**
```typescript
// ai/advanced/
‚îú‚îÄ‚îÄ ContextManager.ts       // Gestion contexte conversation
‚îú‚îÄ‚îÄ DateTimeParser.ts       // Parsing dates/heures NLP
‚îú‚îÄ‚îÄ SmartSuggestions.ts     // Suggestions intelligentes
‚îú‚îÄ‚îÄ LearningEngine.ts       // Apprentissage pr√©f√©rences
‚îî‚îÄ‚îÄ ConversationFlow.ts     // Flow conversation optimis√©
```
**Parsing avanc√© :**
- "mercredi prochain" ‚Üí date exacte
- "15h-17h" ‚Üí cr√©neaux horaires
- "Paul et Marie" ‚Üí participants
- "r√©union √©quipe" ‚Üí contexte m√©tier

- **Gemini test problems** - solve current issues


### Dashboard Improvements
- **Archive system**
  - Bouton "Archiver" dans PollActions
  - Filtre "archived" (actuellement non propos√© dans les boutons de filtre alors que g√©r√© dans `getStatusColor()`)
- **Sorting & pagination**
  - Tri par updated_at, votes_count, participants_count
  - Pagination si > N √©l√©ments
- **Quick sharing**
  - Bouton "Copier le lien public" visible
  - Badge "Lien copi√©"
- **Poll indicators**
  - Meilleure(s) date(s) (r√©sum√© 1‚Äì2 chips) pour les DatePolls
- **Poll claiming**
  - Si cr√©√© sans compte, action "Associer √† mon compte" (flow de claim via token)
- choix de la timezone

### Export Features
- **Format CSV uniquement** pour le MVP (rapide, interop, l√©ger)
- **Points d'entr√©e** : Dashboard et page r√©sultats
- **S√©curit√© MVP** : Liens non indexables, validation permissions basique
- **üìÑ Sp√©cifications d√©taill√©es** : Voir [Specs-Techniques-Export.md](./Specs-Techniques-Export.md)

### Email Templates & Workflows
- **Templates d'emails professionnels** : Cr√©ation, vote confirmation, notifications
- **Flux avec emails automatis√©s**
- **Analytics & Monitoring** : M√©triques usage + performance
- **Tableau de bord d√©veloppeurs**



### Authentication & Security
- **Sans Compte Owner Token** (voir @Sans-Compte-OwnerToken.md)
- **Accessibilit√©** (√©diteur + vote) : Focus management, aria labels
- **Performance** : Rendre uniquement la question active (d√©j√† fait), virtualisation si > 20 questions
- **Analytics dev** : Taux de compl√©tion, abandons par √©tape, erreurs validation

### Deployment & Operations
- **Setup Sentry** : Configuration monitoring production (voir Docs/Monitoring-Production.md)
- **Production Setup** : Domain, hosting, email service, database
- **CI/CD Pipeline** : Tests automatis√©s, branch protection, deployment automation
- **Beta Launch** : 100+ early adopters, mobile-first, feedback collection

## 3. LATER - Advanced Features (Post-MVP)

### PWA Core Features (en r√©flexion)
- **Installable app**
- **Push notifications**
- **Offline functionality**
- **Note** : Statut √† confirmer (MVP ou Post-MVP)

### 3.1 Anti-doublons Avanc√©
- **Double-submit** : D√©sactiver bouton apr√®s clic, idempotence c√¥t√© API (token de soumission)
- **Empreinte locale** : Hash local (device + pollId + contenu) stock√© en localStorage
- **Comportement** : Bloquer ET alerter l'utilisateur (message explicite + impossibilit√© de re-soumettre)
- **Dur√©e du blocage** : Jusqu'√† une nouvelle cr√©ation (pas de d√©lai temporel, blocage permanent pour ce contenu exact)

### 3.3 Calendar Integration (Optional & Discrete)
- **Auto-suggestion** apr√®s s√©lection des dates
- **Direct link**: "Connecter votre calendrier (optionnel)" cliquable
- **Discrete closure**: Croix pour masquer cette section
- **Minimal interface**: Une seule ligne avec lien et bouton fermer
- **Completely optional**: peut √™tre ignor√© ou ferm√©

### 3.4 Mobile Native (Capacitor)
- Transform web app to Android native
- Native APIs integration
- Push notification system complet

### 3.5 Advanced Form Features
- **Reordering & Duplication** : Focus management, raccourcis clavier, annonces ARIA, ID stability
- **Mobile UX** : Indicateur visuel de focus, grandes zones de clic
- **Multilangue** : Passer l'application en multilangue
- **Conditional Logic** : Branching entre questions
- **Scoring System** : Points/poids aux r√©ponses pour priorisation, matching, qualification
- **Quotas Management** : Limites par option/segment, feedback temps-r√©el
- **QUESTION** : √âtats UI quotas (source de v√©rit√© serveur, √©tats √† afficher, seuil "presque plein" 90%/95%?)

### 3.6 Payment System & Monetization
- **Syst√®me de paiement int√©gr√©**
- **Gestion abonnements Pro/Premium**
- **D√©blocage features payantes** (PDF/XLSX export)
- **M√©triques de conversion** et analytics business

### 3.7 File & Media Support
- **File Uploads** dans formulaires
- **Media attachments** pour contexte sondages

### 3.8 Advanced Authentication
- **Forced Authentication** pour r√©pondants (option)
- **Enterprise SSO** integration
- **Advanced permissions** et r√¥les
- **Multi-factor Authentication** pour les comptes administrateurs

---
