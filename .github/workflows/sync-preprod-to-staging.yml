name: ðŸ”„ Sync Pre-prod â†’ Staging

on:
  push:
    branches: [pre-prod]

jobs:
  sync-to-staging:
    name: ðŸ”„ Sync to Staging Branch
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ“¥ Checkout Code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: ðŸ”§ Configure Git
        run: |
          git config --global user.name "Sync Bot"
          git config --global user.email "sync@doodates.com"

      - name: ðŸ”„ Merge to Staging
        run: |
          git checkout staging
          git merge origin/pre-prod --no-ff -m "sync: pre-prod â†’ staging"
          git pull origin staging --rebase
          
      - name: ðŸ“¤ Push to Staging
        run: git push origin staging